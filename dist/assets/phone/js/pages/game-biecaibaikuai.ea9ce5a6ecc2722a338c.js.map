{"version":3,"sources":["webpack:///js/pages/game-biecaibaikuai.ea9ce5a6ecc2722a338c.js","webpack:///./app/phone/assets/audios/syllable ^\\.\\/.*\\.mp3$","webpack:///./app/phone/assets/audios/syllable/1.mp3","webpack:///./app/phone/assets/audios/syllable/2.mp3","webpack:///./app/phone/assets/audios/syllable/3.mp3","webpack:///./app/phone/assets/audios/syllable/4.mp3","webpack:///./app/phone/assets/audios/syllable/5.mp3","webpack:///./app/phone/assets/audios/syllable/6.mp3","webpack:///./app/phone/assets/audios/syllable/7.mp3","webpack:///./app/phone/assets/js/pages/game-biecaibaikuai.js"],"names":["webpackJsonp","100","module","exports","21","__webpack_require__","webpackContext","req","webpackContextResolve","id","map","Error","./1.mp3","./2.mp3","./3.mp3","./4.mp3","./5.mp3","./6.mp3","./7.mp3","keys","Object","resolve","22","p","23","24","25","26","27","28","99","_toConsumableArray","arr","Array","isArray","i","arr2","length","from","_classCallCheck","instance","Constructor","TypeError","_possibleConstructorReturn","self","call","ReferenceError","_inherits","subClass","superClass","prototype","create","constructor","value","enumerable","writable","configurable","setPrototypeOf","__proto__","_createClass","defineProperties","target","props","descriptor","defineProperty","key","protoProps","staticProps","Super","_Super","Sub","this","getPrototypeOf","apply","arguments","randomMap","result","randomRow","tools","getRandom","colNum","max","randomResult","random","col","indexOf","push","forEach","v","item","w","gap","h","move","requestAnimationFrame","ctx","clearRect","row","save","beginPath","fillStyle","rect","step","fill","closePath","restore","hp","setTimeout","alert","score","window","location","reload","drawTxt","index","splice","orientation","applications","canvasWrap","document","querySelector","offsetWidth","documentElement","clientHeight","canvas","createElement","elementName","attribute","width","height","appendChild","getContext","bg","font","textAlign","textBaseline","fillText","audioWrap","audioSrc","hasSound","classList","contains","addEventListener","toggle","isPc","ev","preventDefault","stopPropagation","changedTouches","clientX","offset","left","clientY","isClickSuccess","audioDom","setAttribute","play","style","display"],"mappings":"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","file":"js/pages/game-biecaibaikuai.ea9ce5a6ecc2722a338c.js","sourcesContent":["webpackJsonp([5],{\n\n/***/ 100:\n/***/ (function(module, exports) {\n\n// removed by extract-text-webpack-plugin\n\n/***/ }),\n\n/***/ 21:\n/***/ (function(module, exports, __webpack_require__) {\n\nvar map = {\n\t\"./1.mp3\": 22,\n\t\"./2.mp3\": 23,\n\t\"./3.mp3\": 24,\n\t\"./4.mp3\": 25,\n\t\"./5.mp3\": 26,\n\t\"./6.mp3\": 27,\n\t\"./7.mp3\": 28\n};\nfunction webpackContext(req) {\n\treturn __webpack_require__(webpackContextResolve(req));\n};\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) // check for number or string\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\treturn id;\n};\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 21;\n\n/***/ }),\n\n/***/ 22:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__.p + \"audios/1.38e46759.mp3\";\n\n/***/ }),\n\n/***/ 23:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__.p + \"audios/2.5576c20e.mp3\";\n\n/***/ }),\n\n/***/ 24:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__.p + \"audios/3.25e1d33d.mp3\";\n\n/***/ }),\n\n/***/ 25:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__.p + \"audios/4.220478be.mp3\";\n\n/***/ }),\n\n/***/ 26:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__.p + \"audios/5.ab15dc12.mp3\";\n\n/***/ }),\n\n/***/ 27:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__.p + \"audios/6.44295654.mp3\";\n\n/***/ }),\n\n/***/ 28:\n/***/ (function(module, exports, __webpack_require__) {\n\nmodule.exports = __webpack_require__.p + \"audios/7.c04a5503.mp3\";\n\n/***/ }),\n\n/***/ 99:\n/***/ (function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _toConsumableArray(arr) { if (Array.isArray(arr)) { for (var i = 0, arr2 = Array(arr.length); i < arr.length; i++) { arr2[i] = arr[i]; } return arr2; } else { return Array.from(arr); } }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\n__webpack_require__(100);\nvar Super = __webpack_require__(3);\n\nvar Sub = function (_Super) {\n    _inherits(Sub, _Super);\n\n    function Sub() {\n        _classCallCheck(this, Sub);\n\n        return _possibleConstructorReturn(this, (Sub.__proto__ || Object.getPrototypeOf(Sub)).apply(this, arguments));\n    }\n\n    _createClass(Sub, [{\n        key: 'power',\n        value: function power() {\n            // 横屏的时候 90 -190 , 横屏的时候 0 180\n            if (window.orientation === 90 || window.orientation === -90) {\n                alert('请竖屏之后，刷新页面进行游戏');\n            }\n            var tools = this.tools;\n            var applications = this.applications;\n            var canvasWrap = document.querySelector('.canvas-wrap');\n            var w = canvasWrap.offsetWidth;\n            var h = document.documentElement.clientHeight;\n            var canvas = applications.createElement({\n                elementName: 'canvas',\n                attribute: {\n                    width: w,\n                    height: h\n                }\n            });\n            canvasWrap.appendChild(canvas);\n            var ctx = canvas.getContext('2d');\n            var col = 4;\n            var row = 4;\n            var gap = 10;\n            var step = 10;\n            var score = 0;\n            var hp = 100;\n            var item = {\n                w: (w - (col - 1) * gap) / col,\n                h: (h - (row - 1) * gap) / row,\n                bg: '#000'\n            };\n            var map = [];\n\n            function randomMap() {\n                var result = [];\n                var max = 10;\n                var randomRow = tools.getRandom(0, max);\n                var colNum = 1;\n                if (randomRow === max) {\n                    // 当随机数等于max的时候,一行3个\n                    colNum = 3;\n                }\n                if (randomRow === max / 2) {\n                    // 当随机数等于max/2的时候,一行2个\n                    colNum = 2;\n                }\n                var randomResult = [];\n                // 随机2个时,这2个不允许被随机到同一个位置\n                var random = tools.getRandom(0, col - 1); // 当前这个在这一行是第几个\n                while (randomResult.indexOf(random) === -1 && randomResult.length < colNum) {\n                    randomResult.push(random);\n                    random = tools.getRandom(0, col - 1); // 当前这个在这一行是第几个\n                }\n                randomResult.forEach(function (v) {\n                    result.push([v * item.w + v * gap, -item.h, item.w, item.h]);\n                });\n                return result;\n            }\n\n            var drawTxt = function drawTxt() {\n                ctx.save();\n                ctx.beginPath();\n                ctx.fillStyle = '#f00';\n                ctx.font = '12px 微软雅黑';\n                ctx.textAlign = 'center';\n                ctx.textBaseline = 'middle';\n                ctx.fillText('\\u79EF\\u5206:' + score + ',\\u751F\\u547D\\u503C:' + hp, w / 2, 20);\n                ctx.closePath();\n                ctx.restore();\n            };\n\n            function move() {\n                requestAnimationFrame(function () {\n                    if (map.length === 0) {\n                        map.push(randomMap());\n                    } else {\n                        if (map[map.length - 1][0][1] >= gap) {\n                            map.push(randomMap());\n                        }\n                    }\n                    ctx.clearRect(0, 0, w, h);\n                    map.forEach(function (row) {\n                        row.forEach(function (v) {\n                            ctx.save();\n                            ctx.beginPath();\n                            ctx.fillStyle = '#000';\n                            ctx.rect.apply(ctx, _toConsumableArray(v));\n                            v[1] += step;\n                            ctx.fill();\n                            ctx.closePath();\n                            ctx.restore();\n                        });\n                    });\n                    if (hp < 0) {\n                        setTimeout(function () {\n                            alert('\\u6E38\\u620F\\u7ED3\\u675F,\\u603B\\u79EF\\u5206' + score);\n                            window.location.reload();\n                        }, 60);\n                        return;\n                    }\n                    drawTxt();\n                    map.forEach(function (row, index) {\n                        if (row[0][1] >= h) {\n                            map.splice(index, 1);\n                            hp--;\n                        }\n                    });\n                    move();\n                });\n            }\n\n            // 声音\n            var audioWrap = document.querySelector('.audios-wrap');\n            var audioSrc = [];\n            for (var i = 0; i < 7; i++) {\n                audioSrc.push(__webpack_require__(21)(\"./\" + (i + 1) + '.mp3'));\n            }\n            var hasSound = audioWrap.classList.contains('_on');\n            audioWrap.addEventListener('click', function () {\n                hasSound = !hasSound;\n                this.classList.toggle('_on');\n            });\n\n            var isPc = document.querySelector('html').classList.contains('g-pc');\n\n            // 踩黑块\n            canvas.addEventListener('' + (isPc ? 'click' : 'touchstart'), function (ev) {\n                ev.preventDefault();\n                ev.stopPropagation();\n                ev = isPc ? ev : ev.changedTouches[0];\n                var clientX = ev.clientX - applications.offset(canvasWrap).left;\n                var clientY = ev.clientY;\n                var isClickSuccess = false;\n                map.forEach(function (row, index) {\n                    row.forEach(function (v, i) {\n                        if (clientX >= v[0] && clientX <= v[0] + item.w && clientY >= v[1] && clientY <= v[1] + item.h) {\n                            row.splice(i, 1);\n                            score++;\n                            // 音乐\n                            if (hasSound) {\n                                var audioDom = applications.createElement({ elementName: 'audio' });\n                                // audioDom.setAttribute('src', audioSrc[score % audioSrc.length]);\n                                audioDom.setAttribute('src', audioSrc[tools.getRandom(0, audioSrc.length - 1)]);\n                                audioDom.play();\n                                audioDom = null;\n                            }\n                            isClickSuccess = true;\n                        }\n                    });\n                    if (row.length === 0) {\n                        map.splice(index, 1);\n                    }\n                });\n                if (!isClickSuccess) {\n                    hp--;\n                    if (hp < 0) {\n                        alert('\\u6E38\\u620F\\u7ED3\\u675F,\\u603B\\u79EF\\u5206' + score);\n                        window.location.reload();\n                    }\n                }\n            });\n\n            // 游戏开始\n            document.querySelector('.game-start').addEventListener('click', function () {\n                this.style.display = 'none';\n                audioWrap.style.display = 'none';\n                move();\n            });\n        }\n    }]);\n\n    return Sub;\n}(Super);\n\nnew Sub();\n\n/***/ })\n\n},[99]);\n\n\n// WEBPACK FOOTER //\n// js/pages/game-biecaibaikuai.ea9ce5a6ecc2722a338c.js","var map = {\n\t\"./1.mp3\": 22,\n\t\"./2.mp3\": 23,\n\t\"./3.mp3\": 24,\n\t\"./4.mp3\": 25,\n\t\"./5.mp3\": 26,\n\t\"./6.mp3\": 27,\n\t\"./7.mp3\": 28\n};\nfunction webpackContext(req) {\n\treturn __webpack_require__(webpackContextResolve(req));\n};\nfunction webpackContextResolve(req) {\n\tvar id = map[req];\n\tif(!(id + 1)) // check for number or string\n\t\tthrow new Error(\"Cannot find module '\" + req + \"'.\");\n\treturn id;\n};\nwebpackContext.keys = function webpackContextKeys() {\n\treturn Object.keys(map);\n};\nwebpackContext.resolve = webpackContextResolve;\nmodule.exports = webpackContext;\nwebpackContext.id = 21;\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./app/phone/assets/audios/syllable ^\\.\\/.*\\.mp3$\n// module id = 21\n// module chunks = 4 5","module.exports = __webpack_public_path__ + \"audios/1.38e46759.mp3\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./app/phone/assets/audios/syllable/1.mp3\n// module id = 22\n// module chunks = 4 5","module.exports = __webpack_public_path__ + \"audios/2.5576c20e.mp3\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./app/phone/assets/audios/syllable/2.mp3\n// module id = 23\n// module chunks = 4 5","module.exports = __webpack_public_path__ + \"audios/3.25e1d33d.mp3\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./app/phone/assets/audios/syllable/3.mp3\n// module id = 24\n// module chunks = 4 5","module.exports = __webpack_public_path__ + \"audios/4.220478be.mp3\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./app/phone/assets/audios/syllable/4.mp3\n// module id = 25\n// module chunks = 4 5","module.exports = __webpack_public_path__ + \"audios/5.ab15dc12.mp3\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./app/phone/assets/audios/syllable/5.mp3\n// module id = 26\n// module chunks = 4 5","module.exports = __webpack_public_path__ + \"audios/6.44295654.mp3\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./app/phone/assets/audios/syllable/6.mp3\n// module id = 27\n// module chunks = 4 5","module.exports = __webpack_public_path__ + \"audios/7.c04a5503.mp3\";\n\n\n//////////////////\n// WEBPACK FOOTER\n// ./app/phone/assets/audios/syllable/7.mp3\n// module id = 28\n// module chunks = 4 5","require('../../scss/pages/game-biecaibaikuai.scss');\r\nconst Super = require('../pages-super/super');\r\n\r\nclass Sub extends Super {\r\n    power() {\r\n        // 横屏的时候 90 -190 , 横屏的时候 0 180\r\n        if (window.orientation === 90 || window.orientation === -90) {\r\n            alert('请竖屏之后，刷新页面进行游戏');\r\n        }\r\n        const tools = this.tools;\r\n        const applications = this.applications;\r\n        const canvasWrap = document.querySelector('.canvas-wrap');\r\n        const w = canvasWrap.offsetWidth;\r\n        const h = document.documentElement.clientHeight;\r\n        const canvas = applications.createElement({\r\n            elementName: 'canvas',\r\n            attribute: {\r\n                width: w,\r\n                height: h,\r\n            },\r\n        });\r\n        canvasWrap.appendChild(canvas);\r\n        const ctx = canvas.getContext('2d');\r\n        const col = 4;\r\n        const row = 4;\r\n        const gap = 10;\r\n        const step = 10;\r\n        let score = 0;\r\n        let hp = 100;\r\n        const item = {\r\n            w: (w - (col - 1) * gap) / col,\r\n            h: (h - (row - 1) * gap) / row,\r\n            bg: '#000',\r\n        };\r\n        const map = [];\r\n\r\n        function randomMap() {\r\n            const result = [];\r\n            const max = 10;\r\n            const randomRow = tools.getRandom(0, max);\r\n            let colNum = 1;\r\n            if (randomRow === max) { // 当随机数等于max的时候,一行3个\r\n                colNum = 3;\r\n            }\r\n            if (randomRow === max / 2) { // 当随机数等于max/2的时候,一行2个\r\n                colNum = 2;\r\n            }\r\n            const randomResult = [];\r\n            // 随机2个时,这2个不允许被随机到同一个位置\r\n            let random = tools.getRandom(0, col - 1); // 当前这个在这一行是第几个\r\n            while (randomResult.indexOf(random) === -1 && randomResult.length < colNum) {\r\n                randomResult.push(random);\r\n                random = tools.getRandom(0, col - 1); // 当前这个在这一行是第几个\r\n            }\r\n            randomResult.forEach(function (v) {\r\n                result.push([v * item.w + v * gap, -item.h, item.w, item.h]);\r\n            });\r\n            return result;\r\n        }\r\n\r\n        const drawTxt = function () {\r\n            ctx.save();\r\n            ctx.beginPath();\r\n            ctx.fillStyle = '#f00';\r\n            ctx.font = '12px 微软雅黑';\r\n            ctx.textAlign = 'center';\r\n            ctx.textBaseline = 'middle';\r\n            ctx.fillText(`积分:${score},生命值:${hp}`, w / 2, 20);\r\n            ctx.closePath();\r\n            ctx.restore();\r\n        };\r\n\r\n        function move() {\r\n            requestAnimationFrame(() => {\r\n                if (map.length === 0) {\r\n                    map.push(randomMap());\r\n                } else {\r\n                    if (map[map.length - 1][0][1] >= gap) {\r\n                        map.push(randomMap());\r\n                    }\r\n                }\r\n                ctx.clearRect(0, 0, w, h);\r\n                map.forEach(function (row) {\r\n                    row.forEach(function (v) {\r\n                        ctx.save();\r\n                        ctx.beginPath();\r\n                        ctx.fillStyle = '#000';\r\n                        ctx.rect(...v);\r\n                        v[1] += step;\r\n                        ctx.fill();\r\n                        ctx.closePath();\r\n                        ctx.restore();\r\n                    });\r\n                });\r\n                if (hp < 0) {\r\n                    setTimeout(function () {\r\n                        alert(`游戏结束,总积分${score}`);\r\n                        window.location.reload();\r\n                    }, 60);\r\n                    return;\r\n                }\r\n                drawTxt();\r\n                map.forEach(function (row, index) {\r\n                    if (row[0][1] >= h) {\r\n                        map.splice(index, 1);\r\n                        hp--;\r\n                    }\r\n                });\r\n                move();\r\n            });\r\n        }\r\n\r\n        // 声音\r\n        const audioWrap = document.querySelector('.audios-wrap');\r\n        const audioSrc = [];\r\n        for (let i = 0; i < 7; i++) {\r\n            audioSrc.push(require(`../../audios/syllable/${i + 1}.mp3`));\r\n        }\r\n        let hasSound = audioWrap.classList.contains('_on');\r\n        audioWrap.addEventListener('click', function () {\r\n            hasSound = !hasSound;\r\n            this.classList.toggle('_on');\r\n        });\r\n\r\n        const isPc = document.querySelector('html').classList.contains('g-pc');\r\n\r\n        // 踩黑块\r\n        canvas.addEventListener(`${isPc ? 'click' : 'touchstart'}`, function (ev) {\r\n            ev.preventDefault();\r\n            ev.stopPropagation();\r\n            ev = isPc ? ev : ev.changedTouches[0];\r\n            const clientX = ev.clientX - applications.offset(canvasWrap).left;\r\n            const clientY = ev.clientY;\r\n            let isClickSuccess = false;\r\n            map.forEach(function (row, index) {\r\n                row.forEach(function (v, i) {\r\n                    if (clientX >= v[0] && clientX <= v[0] + item.w && clientY >= v[1] && clientY <= v[1] + item.h) {\r\n                        row.splice(i, 1);\r\n                        score++;\r\n                        // 音乐\r\n                        if (hasSound) {\r\n                            let audioDom = applications.createElement({elementName: 'audio'});\r\n                            // audioDom.setAttribute('src', audioSrc[score % audioSrc.length]);\r\n                            audioDom.setAttribute('src', audioSrc[tools.getRandom(0, audioSrc.length - 1)]);\r\n                            audioDom.play();\r\n                            audioDom = null;\r\n                        }\r\n                        isClickSuccess = true;\r\n                    }\r\n                });\r\n                if (row.length === 0) {\r\n                    map.splice(index, 1);\r\n                }\r\n            });\r\n            if (!isClickSuccess) {\r\n                hp--;\r\n                if (hp < 0) {\r\n                    alert(`游戏结束,总积分${score}`);\r\n                    window.location.reload();\r\n                }\r\n            }\r\n        });\r\n\r\n        // 游戏开始\r\n        document.querySelector('.game-start').addEventListener('click', function () {\r\n            this.style.display = 'none';\r\n            audioWrap.style.display = 'none';\r\n            move();\r\n        });\r\n    }\r\n}\r\n\r\nnew Sub();\r\n\n\n\n// WEBPACK FOOTER //\n// ./app/phone/assets/js/pages/game-biecaibaikuai.js"],"sourceRoot":""}